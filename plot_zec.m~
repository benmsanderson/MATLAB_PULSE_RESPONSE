prnm={'C,T constraints','C,T,heat constraints','C,T,RWF constraints','C,T,Paleo constraints'};
	 
figure(1)
clf
subplot(2,2,1)
areabar(tim3000,topt(:,:,1,1)',10,[0.3,0.8,0.3])
xlim([1950,2250])
hold on
areabar(tim3000,topt(:,:,2,1)',10,[0.5,0.5,0.8])
grid on
xlabel('Year')
ylabel('Temperature (K)')

title('(a)') 

subplot(2,2,2)
areabar(tim3000,eopt(:,:,1,1)',10,[0.3,0.8,0.3])
xlim([1950,2250])
hold on
areabar(tim3000,eopt(:,:,2,1)',10,[0.5,0.5,0.8])
grid on
xlabel('Year')
ylabel('CO_2 Emissions (GtC)')

title('(b)') 


subplot(2,2,3)
hold off
plot(ce_corr(:,1:536,2,1)',topt_corr(:,1:536,2,1)'+mean(gm_had(158:167)),'color',[0.5,0.5,0.8]/2+0.5)

  
hold on

plot(ce_corr(:,1:536,1,1)',topt_corr(:,1:536,1,1)'+mean(gm_had(158:167)),'color',[0.3,0.8,0.3]/2+0.5)
plot(ce_corr(1,85+(1:167),1,1)',gm_had,'color','k','linewidth',1)

ah1=hist(ce_corr(:,286,1,1),[-500:25:1500])
plot([-500:25:1500],ah1/max(ah1),'color',[0.3,0.8,0.3])

ah=hist(ce_corr(:,286,2,1),[-500:25:1500])
plot([-500:25:1500],ah/max(ah),'color',[0.5,0.5,0.8])

ah=hist(ce_corr(:,336,1,1),[-500:200:1500])
plot([-500:200:1500],ah/max(ah)/5,'--','color',[0.3,0.8,0.3])

ah=hist(ce_corr(:,336,2,1),[-500:200:1500])
plot([-500:200:1500],ah/max(ah)/5,'--','color',[0.5,0.5,0.8])



xlabel({'Post-2010 Cumulative','CO_2 Emissions (GtC)'})
ylabel('Temperature above 1850 (K)')
xlim([-500,1500])
ylim([0,2.5])
grid on
title('(c)') 

subplot(2,2,4)
hold off
areabar(tim3000(246:end),ce_corr(:,246:end,1,1)',10,[0.3,0.8,0.3]);
xlim([1960,2300])
ylim([-300,1000])

hold on
budg_tcre=(1.5-mean(gm_had(158:167)))./tcrematnl*1000/44*12;
topt_nco=mean(topt(:,242:251,1,1)-topt_co(:,242:251,1,1),2);
budg_nco=(1.5-mean(gm_had(158:167)-topt_nco'))./tcrematnl(1:numel(topt_nco))*1000/44*12;

pr_tc=prctile(budg_tcre,[10,50,90])
pr_nco=prctile(budg_nco,[10,50,90])

errorbar(1980,pr_tc(2),pr_tc(2)-pr_tc(1),pr_tc(3)-pr_tc(2),'marker','x','color',[0.3,0.8,0.3],'linewidth',1)
errorbar(2010,pr_nco(2),pr_nco(2)-pr_nco(1),pr_nco(3)-pr_nco(2),'marker','d','color',[0.3,0.8,0.3],'linewidth',1)

 areabar(tim3000(246:end),ce_corr(:,246:end,2,1)',10,[0.5,0.5,0.8]);

 
budg_tcre=(2-mean(gm_had(158:167)))./tcrematnl*1000/44*12;
topt_nco=mean(topt(:,242:251,1,1)-topt_co(:,242:251,1,1),2);
budg_nco=(2-mean(gm_had(158:167)-topt_nco'))./tcrematnl(1:numel(topt_nco))*1000/44*12;

pr_tc=prctile(budg_tcre,[10,50,90])
pr_nco=prctile(budg_nco,[10,50,90])

errorbar(1980,pr_tc(2),pr_tc(2)-pr_tc(1),pr_tc(3)-pr_tc(2),'marker','x','color',[0.5,0.5,0.8],'linewidth',1)
errorbar(2010,pr_nco(2),pr_nco(2)-pr_nco(1),pr_nco(3)-pr_nco(2),'marker','d','color',[0.5,0.5,0.8],'linewidth',1)

ylabel({'Post 2010 Cumulative','Emissions budget (GtC)'})
xlabel('Accounting date')



grid on
title('(d)') 
 



   
   set(gcf, 'PaperPosition', [0 0 9 8]);
set(gcf, 'PaperSize', [9 8]); 
print(gcf,'-dpdf','-painters',['budget.pdf']);


  
  figure(2)
clf

hold off
for i=1:4
subplot(2,2,i)
  areabar(tim3000(246:end),ce_corr(:,246:end,1,i)',10,[0.3,0.8,0.3]);
xlim([1960,2300])
ylim([-300,1000])
topt_nco=mean(topt(:,242:251,1,i)-topt_co(:,242:251,1,i),2);

hold on
switch i
  case 1
budg_tcre=(1.5-mean(gm_had(158:167)))./tcrematnl*1000/44*12;
budg_nco=(1.5-mean(gm_had(158:167)-topt_nco'))./tcrematnl(1:numel(topt_nco))*1000/44*12;
 case 2
budg_tcre=(1.5-mean(gm_had(158:167)))./tcremat*1000/44*12;
budg_nco=(1.5-mean(gm_had(158:167)-topt_nco'))./tcremat(1:numel(topt_nco))*1000/44*12;
 case 3
budg_tcre=(1.5-mean(gm_had(158:167)))./tcrematml*1000/44*12;
budg_nco=(1.5-mean(gm_had(158:167)-topt_nco'))./tcrematml(1:numel(topt_nco))*1000/44*12;
 case 4
budg_tcre=(1.5-mean(gm_had(158:167)))./tcrematcf*1000/44*12;
budg_nco=(1.5-mean(gm_had(158:167)-topt_nco'))./tcrematcf(1:numel(topt_nco))*1000/44*12;
end


pr_tc=prctile(budg_tcre,[10,50,90])
pr_nco=prctile(budg_nco,[10,50,90])

errorbar(1980,pr_tc(2),pr_tc(2)-pr_tc(1),pr_tc(3)-pr_tc(2),'marker','x','color',[0.3,0.8,0.3],'linewidth',1)
errorbar(2010,pr_nco(2),pr_nco(2)-pr_nco(1),pr_nco(3)-pr_nco(2),'marker','d','color',[0.3,0.8,0.3],'linewidth',1)

 areabar(tim3000(246:end),ce_corr(:,246:end,2,i)',10,[0.5,0.5,0.8]);
topt_nco=mean(topt(:,242:251,1,1)-topt_co(:,242:251,1,1),2);

 switch i
  case 1
budg_tcre=(2-mean(gm_had(158:167)))./tcrematnl(1:numel(topt_nco))*1000/44*12;
budg_nco=(2-mean(gm_had(158:167)-topt_nco'))./tcrematnl(1:numel(topt_nco))*1000/44*12;
  case 2
budg_tcre=(2-mean(gm_had(158:167)))./tcremat(1:numel(topt_nco))*1000/44*12;
budg_nco=(2-mean(gm_had(158:167)-topt_nco'))./tcremat(1:numel(topt_nco))*1000/44*12;
  case 3
budg_tcre=(2-mean(gm_had(158:167)))./tcrematml(1:numel(topt_nco))*1000/44*12;
budg_nco=(2-mean(gm_had(158:167)-topt_nco'))./tcrematml(1:numel(topt_nco))*1000/44*12;
  case 4
budg_tcre=(2-mean(gm_had(158:167)))./tcrematcf(1:numel(topt_nco))*1000/44*12;
budg_nco=(2-mean(gm_had(158:167)-topt_nco'))./tcrematcf(1:numel(topt_nco))*1000/44*12;
 end
 
pr_tc=prctile(budg_tcre,[10,50,90])
pr_nco=prctile(budg_nco,[10,50,90])

errorbar(1980,pr_tc(2),pr_tc(2)-pr_tc(1),pr_tc(3)-pr_tc(2),'marker','x','color',[0.5,0.5,0.8],'linewidth',1)
errorbar(2010,pr_nco(2),pr_nco(2)-pr_nco(1),pr_nco(3)-pr_nco(2),'marker','d','color',[0.5,0.5,0.8],'linewidth',1)

ylabel({'Post 2010 Cumulative','Emissions budget (GtC)'})
xlabel('Accouting date')

grid on
title(['(' char(96+i) ') ' prnm{i} ]) 

end 



   
   set(gcf, 'PaperPosition', [0 0 9 8]);
set(gcf, 'PaperSize', [9 8]); 
print(gcf,'-dpdf','-painters',['budget_ps.pdf']);


  
  
 
figure(3)
clf
for i=1:4
subplot(2,2,i)
areabar(tim3000,topt(:,:,1,i)',10,[0.3,0.8,0.3])
xlim([1950,2250])
hold on
areabar(tim3000,topt(:,:,2,i)',10,[0.5,0.5,0.8])
grid on
xlabel('Year')
ylabel('Temperature (K)')
title(['(' char(96+i) ') ' prnm{i} ]) 

end

   
   set(gcf, 'PaperPosition', [0 0 9 8]);
set(gcf, 'PaperSize', [9 8]); 
print(gcf,'-dpdf','-painters',['budget_ts.pdf']);



 
figure(4)
clf
for i=1:4
subplot(2,2,i)
areabar(tim3000,eopt(:,:,1,i)',10,[0.3,0.8,0.3])
xlim([1950,2250])
hold on
areabar(tim3000,eopt(:,:,2,i)',10,[0.5,0.5,0.8])
grid on
xlabel('Year')
ylabel('Emissions (GtC)')
ylim([-5,10])
end

   
   set(gcf, 'PaperPosition', [0 0 9 8]);
set(gcf, 'PaperSize', [9 8]); 
print(gcf,'-dpdf','-painters',['budget_e.pdf']);




figure(5)
for i=1:4
subplot(2,2,i)
hold off
plot(ce_corr(:,1:536,2,i)',topt_corr(:,1:536,2,i)'+mean(gm_had(158:167)),'color',[0.5,0.5,0.8]/2+0.5)

  
hold on

plot(ce_corr(:,1:536,1,i)',topt_corr(:,1:536,1,i)'+mean(gm_had(158:167)),'color',[0.3,0.8,0.3]/2+0.5)
plot(ce_corr(1,85+(1:167),1,i)',gm_had,'color','k','linewidth',1)

ah1=hist(ce_corr(:,286,1,i),[-500:25:1500])
plot([-500:25:1500],ah1/max(ah1),'color',[0.3,0.8,0.3])

ah=hist(ce_corr(:,286,2,i),[-500:25:1500])
plot([-500:25:1500],ah/max(ah),'color',[0.5,0.5,0.8])

ah=hist(ce_corr(:,336,1,i),[-500:200:1500])
plot([-500:200:1500],ah/max(ah)/5,'--','color',[0.3,0.8,0.3])

ah=hist(ce_corr(:,336,2,i),[-500:200:1500])
plot([-500:200:1500],ah/max(ah)/5,'--','color',[0.5,0.5,0.8])



xlabel({'Post-2010 Cumulative','CO_2 Emissions (GtC)'})
ylabel('Temperature above 1850 (K)')
xlim([-500,1500])
ylim([0,2.5])
grid on
title(['(' char(96+i) ') ' prnm{i} ]) 
end

   
   set(gcf, 'PaperPosition', [0 0 9 8]);
set(gcf, 'PaperSize', [9 8]); 
print(gcf,'-dpdf','-painters',['budget_plume.pdf']);

