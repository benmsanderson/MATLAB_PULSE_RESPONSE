
figure(1)
clf
 subplot(2,3,1)

 ah=hist(btrnd,[-.004:0.0004:0.004])
 bh=hist(driftamp,[-.004:0.0004:0.004])
 
 b=bar([-.4:0.04:0.4],[bh/sum(bh);ah/sum(ah)]'*100,1)
 set(b(1),'FaceColor',[0.5,0.5,0.5])
 set(b(2),'FaceColor','k')
legend(b,'Idealized Drift ensemble','CMIP PIControl')
 xlabel('Control Drift (K/century)')
 ylabel('Relative Frequency')
 title('(a)')
 subplot(2,3,2)

 p1=plot(-499:150,t_drift(:,1:10:end),'color',[0.5,0.5,0.8])
 hold on
 p2=plot(-499:150,tcr_drift(:,1:10:end),'color',[0.5,0.8,0.5])
 p3=plot(-499:0,t_drift(1:500,1:10:end),'color',[0.5,0.5,0.5])

 plot(-499:150,t_drift(:,find(driftmat==0)),'--','color',[0.5,0.5,0.8]/2,'linewidth',2)
 plot(-499:150,tcr_drift(:,find(driftmat==0)),'--','color',[0.5,0.8,0.5]/2,'linewidth',2)
 plot(-499:0,t_drift(1:500,find(driftmat==0)),'--','color',[0.5,0.5,0.5]/2,'linewidth',2)
 ylim([-1,5])
xlim([-200,150])

 
 xlabel('years')
 ylabel('(K)')


 plot([-100,-100],[-1,5],'k:')
  plot([0,00],[-1,5],'k:')

  legend([p3(1),p2(1),p1(1)],'Drift (example model)','Drift+1pctCO2','Drift+4xCO2','location','northwest')
   title('(b)')

 subplot(2,3,3)

 p1=plot(t_drift(501:end,1:10:end),r_drift(501:end,1:10:end),'color',[0.5,0.5,0.8])
 
 hold on
% p2=plot(tcr_drift(:,1:10:end),tcr_drift(:,1:10:end),'color',[0.5,0.8,0.5])
 p3=plot(t_drift(1:500,1:10:end),r_drift(1:500,1:10:end),'color',[0.5,0.5,0.5])
 p1=plot(t_drift(end,1:50:end),r_drift(end,1:50:end),'x','color',[0.5,0.5,0.8],'linewidth',3)
 p1=plot(t_drift(501,1:50:end),r_drift(501,1:50:end),'d','color',[0.5,0.5,0.8])
 p1=plot(t_drift(500:501,1:50:end),r_drift(500:501,1:50:end),':','color',[0.5,0.5,0.5])

for i=1:10:100
  b=regress(r_drift(501:end,i),[ones(size(t_drift(501:end,i))),t_drift(501:end,i)])
  plot([-5,15],[1,1;-5,15]'*b,'--','color',[0.5,0.5,0.8])
end

% plot(-499:150,t_drift(:,find(driftmat==0)),'--','color',[0.5,0.5,0.8]/2,'linewidth',2)
% plot(-499:150,tcr_drift(:,find(driftmat==0)),'--','color',[0.5,0.8,0.5]/2,'linewidth',2)
% plot(-499:0,t_drift(1:500,find(driftmat==0)),'--','color',[0.5,0.5,0.5]/2,'linewidth',2)
 ylim([-5,15])
 xlim([-5,15])
 plot([-10,15],[0,0],'k:')
  plot([0,0],[-10,15],'k:')

%xlim([-200,150])

 
 ylabel('(Wm^{-2})')
 xlabel('(K)')



%  legend([p3(1),p2(1),p1(1)],'Drift (example model)','Drift+1pctCO2','Drift+4xCO2','location','northwest')
   title('(c)')

 subplot(2,3,4)
 plot(gregmat_drift,gregmat,'.','color',[0.5,0.5,0.8],'markersize',6)
 [b,~,~,~,stats]=regress(gregmat',[gregmat_drift']);
 hold on
 p11=plot([0,15],[0,15]'*b,':','linewidth',1.5,'color',[0.5,0.5,0.8])
 legend([p11],['A140 R^2=' num2str(stats(1),2)],'location','northwest')


% plot(tcr4mat_drift,gregmat,'.','color',[0.5,0.8,0.5],'markersize',6)
% [b,~,~,~,stats2]=regress(gregmat',[tcr4mat_drift',ones(size(gregmat_drift'))]);
% hold on
% p12=plot([0,15],[0,15;1,1]'*b,':','linewidth',1.5,'color',[0.5,0.8,0.5])

% plot(tcr4fit,gregmat,'.','color',[0.8,0.5,0.5],'markersize',6)
% [b,~,~,~,stats3]=regress(gregmat',[tcr4fit',ones(size(gregmat_drift'))]);
% hold on
% p13=plot([0,15],[0,15;1,1]'*b,':','linewidth',1.5,'color',[0.8,0.5,0.5])




 
 legend([p11],['EffCS R^2=' num2str(stats(1),2)],'location','northwest')
% legend([p11,p12,p13],['EffCS R^2=' num2str(stats(1),2)],['T140 R^2=' num2str(stats2(1),2)],['T140 (4xCO2 fit) R^2=' num2str(stats3(1),2)],'location','northwest')
 ylabel('True EffCS (K, no drift)')
 xlabel('Measured value (K, with drift)')
 axis([0,15,0,15])
 title('(d)')

 subplot(2,3,5)
 p1=plot(tcr4mat_drift,tcr4mat,'.','color',[0.5,0.8,0.5],'markersize',6)
  [b,~,~,~,stats]=regress(tcr4mat',[tcr4mat_drift',ones(size(tcr4mat_drift'))]);
 hold on
 p11=plot([0,15],[0,15;1,1]'*b,':','linewidth',1.5,'color',[0.5,0.8,0.5])

 hold on
 p2=plot(gregmat_drift,tcr4mat,'.','color',[0.5,0.5,0.8],'markersize',6)
 [b,~,~,~,stats2]=regress(tcr4mat',[gregmat_drift',ones(size(tcr4mat_drift'))]);
 hold on
 p12=plot([0,15],[0,15;1,1]'*b,':','linewidth',1.5,'color',[0.5,0.5,0.8])

 %hold on
% p3=plot(tcr4fit,tcr4mat,'.','color',[0.8,0.5,0.5],'markersize',6)
 %[b,~,~,~,stats3]=regress(tcr4mat',[tcr4fit',ones(size(tcr4mat_drift'))]);
% hold on
% p13=plot([0,15],[0,15;1,1]'*b,':','linewidth',1.5,'color',[0.8,0.5,0.5])

%legend([p11,p12,p13],['T140 R^2=' num2str(stats(1),2)],['EffCS R^2=' num2str(stats2(1),2)],['T140 (4xCO2 fit) R^2=' num2str(stats3(1),2)],'location','northwest')
 legend([p11,p12],['T140 R^2=' num2str(stats(1),2)],['EffCS R^2=' num2str(stats2(1),2)],'location','northwest')
 
 ylabel('True T140 (K, no drift)')
  xlabel('Measured value (K, with drift)')
 title('(e)')
 axis([0,15,0,15])

 subplot(2,3,6)
 p1=plot(drift_a140,abs(stmat(:,150)'),'.','color',[0.5,0.8,0.5],'markersize',6)
  [b,~,~,~,stats]=regress(stmat(:,150),[drift_a140',ones(size(tcr4mat_drift'))]);
 hold on
 p11=plot([0,15],[0,15;1,1]'*b,':','linewidth',1.5,'color',[0.5,0.8,0.5])
 ylabel('True a140 (K, no drift)')
  xlabel('Measured value (K, with drift)')
 title('(f)')
 axis([0,15,0,15])

 legend([p11],['A140 R^2=' num2str(stats(1),2)],'location','northwest')
   set(gcf, 'PaperPosition', [0 0 9.5 5.5]);
set(gcf, 'PaperSize', [9.5 5.5]); 
print(gcf,'-dpdf','-painters',['drift.pdf']);
